{"ast":null,"code":"'use strict';\n\nvar createLinePlot = require('../../../stackgl_modules').gl_line3d;\nvar createScatterPlot = require('../../../stackgl_modules').gl_scatter3d;\nvar createErrorBars = require('../../../stackgl_modules').gl_error3d;\nvar createMesh = require('../../../stackgl_modules').gl_mesh3d;\nvar triangulate = require('../../../stackgl_modules').delaunay_triangulate;\nvar Lib = require('../../lib');\nvar str2RgbaArray = require('../../lib/str2rgbarray');\nvar formatColor = require('../../lib/gl_format_color').formatColor;\nvar makeBubbleSizeFn = require('../scatter/make_bubble_size_func');\nvar DASH_PATTERNS = require('../../constants/gl3d_dashes');\nvar MARKER_SYMBOLS = require('../../constants/gl3d_markers');\nvar Axes = require('../../plots/cartesian/axes');\nvar appendArrayPointValue = require('../../components/fx/helpers').appendArrayPointValue;\nvar calculateError = require('./calc_errors');\nfunction LineWithMarkers(scene, uid) {\n  this.scene = scene;\n  this.uid = uid;\n  this.linePlot = null;\n  this.scatterPlot = null;\n  this.errorBars = null;\n  this.textMarkers = null;\n  this.delaunayMesh = null;\n  this.color = null;\n  this.mode = '';\n  this.dataPoints = [];\n  this.axesBounds = [[-Infinity, -Infinity, -Infinity], [Infinity, Infinity, Infinity]];\n  this.textLabels = null;\n  this.data = null;\n}\nvar proto = LineWithMarkers.prototype;\nproto.handlePick = function (selection) {\n  if (selection.object && (selection.object === this.linePlot || selection.object === this.delaunayMesh || selection.object === this.textMarkers || selection.object === this.scatterPlot)) {\n    var ind = selection.index = selection.data.index;\n    if (selection.object.highlight) {\n      selection.object.highlight(null);\n    }\n    if (this.scatterPlot) {\n      selection.object = this.scatterPlot;\n      this.scatterPlot.highlight(selection.data);\n    }\n    selection.textLabel = '';\n    if (this.textLabels) {\n      if (Array.isArray(this.textLabels)) {\n        if (this.textLabels[ind] || this.textLabels[ind] === 0) {\n          selection.textLabel = this.textLabels[ind];\n        }\n      } else {\n        selection.textLabel = this.textLabels;\n      }\n    }\n    selection.traceCoordinate = [this.data.x[ind], this.data.y[ind], this.data.z[ind]];\n    return true;\n  }\n};\nfunction constructDelaunay(points, color, axis) {\n  var u = (axis + 1) % 3;\n  var v = (axis + 2) % 3;\n  var filteredPoints = [];\n  var filteredIds = [];\n  var i;\n  for (i = 0; i < points.length; ++i) {\n    var p = points[i];\n    if (isNaN(p[u]) || !isFinite(p[u]) || isNaN(p[v]) || !isFinite(p[v])) {\n      continue;\n    }\n    filteredPoints.push([p[u], p[v]]);\n    filteredIds.push(i);\n  }\n  var cells = triangulate(filteredPoints);\n  for (i = 0; i < cells.length; ++i) {\n    var c = cells[i];\n    for (var j = 0; j < c.length; ++j) {\n      c[j] = filteredIds[c[j]];\n    }\n  }\n  return {\n    positions: points,\n    cells: cells,\n    meshColor: color\n  };\n}\nfunction calculateErrorParams(errors) {\n  var capSize = [0.0, 0.0, 0.0];\n  var color = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n  var lineWidth = [1.0, 1.0, 1.0];\n  for (var i = 0; i < 3; i++) {\n    var e = errors[i];\n    if (e && e.copy_zstyle !== false && errors[2].visible !== false) e = errors[2];\n    if (!e || !e.visible) continue;\n    capSize[i] = e.width / 2; // ballpark rescaling\n    color[i] = str2RgbaArray(e.color);\n    lineWidth[i] = e.thickness;\n  }\n  return {\n    capSize: capSize,\n    color: color,\n    lineWidth: lineWidth\n  };\n}\nfunction parseAlignmentX(a) {\n  if (a === null || a === undefined) return 0;\n  return a.indexOf('left') > -1 ? -1 : a.indexOf('right') > -1 ? 1 : 0;\n}\nfunction parseAlignmentY(a) {\n  if (a === null || a === undefined) return 0;\n  return a.indexOf('top') > -1 ? -1 : a.indexOf('bottom') > -1 ? 1 : 0;\n}\nfunction calculateTextOffset(tp) {\n  // Read out text properties\n\n  var defaultAlignmentX = 0;\n  var defaultAlignmentY = 0;\n  var textOffset = [defaultAlignmentX, defaultAlignmentY];\n  if (Array.isArray(tp)) {\n    for (var i = 0; i < tp.length; i++) {\n      textOffset[i] = [defaultAlignmentX, defaultAlignmentY];\n      if (tp[i]) {\n        textOffset[i][0] = parseAlignmentX(tp[i]);\n        textOffset[i][1] = parseAlignmentY(tp[i]);\n      }\n    }\n  } else {\n    textOffset[0] = parseAlignmentX(tp);\n    textOffset[1] = parseAlignmentY(tp);\n  }\n  return textOffset;\n}\nfunction calculateSize(sizeIn, sizeFn) {\n  // rough parity with Plotly 2D markers\n  return sizeFn(sizeIn * 4);\n}\nfunction calculateSymbol(symbolIn) {\n  return MARKER_SYMBOLS[symbolIn];\n}\nfunction formatParam(paramIn, len, calculate, dflt, extraFn) {\n  var paramOut = null;\n  if (Lib.isArrayOrTypedArray(paramIn)) {\n    paramOut = [];\n    for (var i = 0; i < len; i++) {\n      if (paramIn[i] === undefined) paramOut[i] = dflt;else paramOut[i] = calculate(paramIn[i], extraFn);\n    }\n  } else paramOut = calculate(paramIn, Lib.identity);\n  return paramOut;\n}\nfunction convertPlotlyOptions(scene, data) {\n  var points = [];\n  var sceneLayout = scene.fullSceneLayout;\n  var scaleFactor = scene.dataScale;\n  var xaxis = sceneLayout.xaxis;\n  var yaxis = sceneLayout.yaxis;\n  var zaxis = sceneLayout.zaxis;\n  var marker = data.marker;\n  var line = data.line;\n  var x = data.x || [];\n  var y = data.y || [];\n  var z = data.z || [];\n  var len = x.length;\n  var xcalendar = data.xcalendar;\n  var ycalendar = data.ycalendar;\n  var zcalendar = data.zcalendar;\n  var xc, yc, zc;\n  var params, i;\n  var text;\n\n  // Convert points\n  for (i = 0; i < len; i++) {\n    // sanitize numbers and apply transforms based on axes.type\n    xc = xaxis.d2l(x[i], 0, xcalendar) * scaleFactor[0];\n    yc = yaxis.d2l(y[i], 0, ycalendar) * scaleFactor[1];\n    zc = zaxis.d2l(z[i], 0, zcalendar) * scaleFactor[2];\n    points[i] = [xc, yc, zc];\n  }\n\n  // convert text\n  if (Array.isArray(data.text)) text = data.text;else if (data.text !== undefined) {\n    text = new Array(len);\n    for (i = 0; i < len; i++) text[i] = data.text;\n  }\n  function formatter(axName, val) {\n    var ax = sceneLayout[axName];\n    return Axes.tickText(ax, ax.d2l(val), true).text;\n  }\n\n  // check texttemplate\n  var texttemplate = data.texttemplate;\n  if (texttemplate) {\n    var fullLayout = scene.fullLayout;\n    var d3locale = fullLayout._d3locale;\n    var isArray = Array.isArray(texttemplate);\n    var N = isArray ? Math.min(texttemplate.length, len) : len;\n    var txt = isArray ? function (i) {\n      return texttemplate[i];\n    } : function () {\n      return texttemplate;\n    };\n    text = new Array(N);\n    for (i = 0; i < N; i++) {\n      var d = {\n        x: x[i],\n        y: y[i],\n        z: z[i]\n      };\n      var labels = {\n        xLabel: formatter('xaxis', x[i]),\n        yLabel: formatter('yaxis', y[i]),\n        zLabel: formatter('zaxis', z[i])\n      };\n      var pointValues = {};\n      appendArrayPointValue(pointValues, data, i);\n      var meta = data._meta || {};\n      text[i] = Lib.texttemplateString(txt(i), labels, d3locale, pointValues, d, meta);\n    }\n  }\n\n  // Build object parameters\n  params = {\n    position: points,\n    mode: data.mode,\n    text: text\n  };\n  if ('line' in data) {\n    params.lineColor = formatColor(line, 1, len);\n    params.lineWidth = line.width;\n    params.lineDashes = line.dash;\n  }\n  if ('marker' in data) {\n    var sizeFn = makeBubbleSizeFn(data);\n    params.scatterColor = formatColor(marker, 1, len);\n    params.scatterSize = formatParam(marker.size, len, calculateSize, 20, sizeFn);\n    params.scatterMarker = formatParam(marker.symbol, len, calculateSymbol, '●');\n    params.scatterLineWidth = marker.line.width; // arrayOk === false\n    params.scatterLineColor = formatColor(marker.line, 1, len);\n    params.scatterAngle = 0;\n  }\n  if ('textposition' in data) {\n    params.textOffset = calculateTextOffset(data.textposition);\n    params.textColor = formatColor(data.textfont, 1, len);\n    params.textSize = formatParam(data.textfont.size, len, Lib.identity, 12);\n    params.textFont = data.textfont.family; // arrayOk === false\n    params.textAngle = 0;\n  }\n  var dims = ['x', 'y', 'z'];\n  params.project = [false, false, false];\n  params.projectScale = [1, 1, 1];\n  params.projectOpacity = [1, 1, 1];\n  for (i = 0; i < 3; ++i) {\n    var projection = data.projection[dims[i]];\n    if (params.project[i] = projection.show) {\n      params.projectOpacity[i] = projection.opacity;\n      params.projectScale[i] = projection.scale;\n    }\n  }\n  params.errorBounds = calculateError(data, scaleFactor, sceneLayout);\n  var errorParams = calculateErrorParams([data.error_x, data.error_y, data.error_z]);\n  params.errorColor = errorParams.color;\n  params.errorLineWidth = errorParams.lineWidth;\n  params.errorCapSize = errorParams.capSize;\n  params.delaunayAxis = data.surfaceaxis;\n  params.delaunayColor = str2RgbaArray(data.surfacecolor);\n  return params;\n}\nfunction _arrayToColor(color) {\n  if (Lib.isArrayOrTypedArray(color)) {\n    var c = color[0];\n    if (Lib.isArrayOrTypedArray(c)) color = c;\n    return 'rgb(' + color.slice(0, 3).map(function (x) {\n      return Math.round(x * 255);\n    }) + ')';\n  }\n  return null;\n}\nfunction arrayToColor(colors) {\n  if (!Lib.isArrayOrTypedArray(colors)) {\n    return null;\n  }\n  if (colors.length === 4 && typeof colors[0] === 'number') {\n    return _arrayToColor(colors);\n  }\n  return colors.map(_arrayToColor);\n}\nproto.update = function (data) {\n  var gl = this.scene.glplot.gl;\n  var lineOptions;\n  var scatterOptions;\n  var errorOptions;\n  var textOptions;\n  var dashPattern = DASH_PATTERNS.solid;\n\n  // Save data\n  this.data = data;\n\n  // Run data conversion\n  var options = convertPlotlyOptions(this.scene, data);\n  if ('mode' in options) {\n    this.mode = options.mode;\n  }\n  if ('lineDashes' in options) {\n    if (options.lineDashes in DASH_PATTERNS) {\n      dashPattern = DASH_PATTERNS[options.lineDashes];\n    }\n  }\n  this.color = arrayToColor(options.scatterColor) || arrayToColor(options.lineColor);\n\n  // Save data points\n  this.dataPoints = options.position;\n  lineOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.lineColor,\n    lineWidth: options.lineWidth || 1,\n    dashes: dashPattern[0],\n    dashScale: dashPattern[1],\n    opacity: data.opacity,\n    connectGaps: data.connectgaps\n  };\n  if (this.mode.indexOf('lines') !== -1) {\n    if (this.linePlot) this.linePlot.update(lineOptions);else {\n      this.linePlot = createLinePlot(lineOptions);\n      this.linePlot._trace = this;\n      this.scene.glplot.add(this.linePlot);\n    }\n  } else if (this.linePlot) {\n    this.scene.glplot.remove(this.linePlot);\n    this.linePlot.dispose();\n    this.linePlot = null;\n  }\n\n  // N.B. marker.opacity must be a scalar for performance\n  var scatterOpacity = data.opacity;\n  if (data.marker && data.marker.opacity) scatterOpacity *= data.marker.opacity;\n  scatterOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.scatterColor,\n    size: options.scatterSize,\n    glyph: options.scatterMarker,\n    opacity: scatterOpacity,\n    orthographic: true,\n    lineWidth: options.scatterLineWidth,\n    lineColor: options.scatterLineColor,\n    project: options.project,\n    projectScale: options.projectScale,\n    projectOpacity: options.projectOpacity\n  };\n  if (this.mode.indexOf('markers') !== -1) {\n    if (this.scatterPlot) this.scatterPlot.update(scatterOptions);else {\n      this.scatterPlot = createScatterPlot(scatterOptions);\n      this.scatterPlot._trace = this;\n      this.scatterPlot.highlightScale = 1;\n      this.scene.glplot.add(this.scatterPlot);\n    }\n  } else if (this.scatterPlot) {\n    this.scene.glplot.remove(this.scatterPlot);\n    this.scatterPlot.dispose();\n    this.scatterPlot = null;\n  }\n  textOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    glyph: options.text,\n    color: options.textColor,\n    size: options.textSize,\n    angle: options.textAngle,\n    alignment: options.textOffset,\n    font: options.textFont,\n    orthographic: true,\n    lineWidth: 0,\n    project: false,\n    opacity: data.opacity\n  };\n  this.textLabels = data.hovertext || data.text;\n  if (this.mode.indexOf('text') !== -1) {\n    if (this.textMarkers) this.textMarkers.update(textOptions);else {\n      this.textMarkers = createScatterPlot(textOptions);\n      this.textMarkers._trace = this;\n      this.textMarkers.highlightScale = 1;\n      this.scene.glplot.add(this.textMarkers);\n    }\n  } else if (this.textMarkers) {\n    this.scene.glplot.remove(this.textMarkers);\n    this.textMarkers.dispose();\n    this.textMarkers = null;\n  }\n  errorOptions = {\n    gl: this.scene.glplot.gl,\n    position: options.position,\n    color: options.errorColor,\n    error: options.errorBounds,\n    lineWidth: options.errorLineWidth,\n    capSize: options.errorCapSize,\n    opacity: data.opacity\n  };\n  if (this.errorBars) {\n    if (options.errorBounds) {\n      this.errorBars.update(errorOptions);\n    } else {\n      this.scene.glplot.remove(this.errorBars);\n      this.errorBars.dispose();\n      this.errorBars = null;\n    }\n  } else if (options.errorBounds) {\n    this.errorBars = createErrorBars(errorOptions);\n    this.errorBars._trace = this;\n    this.scene.glplot.add(this.errorBars);\n  }\n  if (options.delaunayAxis >= 0) {\n    var delaunayOptions = constructDelaunay(options.position, options.delaunayColor, options.delaunayAxis);\n    delaunayOptions.opacity = data.opacity;\n    if (this.delaunayMesh) {\n      this.delaunayMesh.update(delaunayOptions);\n    } else {\n      delaunayOptions.gl = gl;\n      this.delaunayMesh = createMesh(delaunayOptions);\n      this.delaunayMesh._trace = this;\n      this.scene.glplot.add(this.delaunayMesh);\n    }\n  } else if (this.delaunayMesh) {\n    this.scene.glplot.remove(this.delaunayMesh);\n    this.delaunayMesh.dispose();\n    this.delaunayMesh = null;\n  }\n};\nproto.dispose = function () {\n  if (this.linePlot) {\n    this.scene.glplot.remove(this.linePlot);\n    this.linePlot.dispose();\n  }\n  if (this.scatterPlot) {\n    this.scene.glplot.remove(this.scatterPlot);\n    this.scatterPlot.dispose();\n  }\n  if (this.errorBars) {\n    this.scene.glplot.remove(this.errorBars);\n    this.errorBars.dispose();\n  }\n  if (this.textMarkers) {\n    this.scene.glplot.remove(this.textMarkers);\n    this.textMarkers.dispose();\n  }\n  if (this.delaunayMesh) {\n    this.scene.glplot.remove(this.delaunayMesh);\n    this.delaunayMesh.dispose();\n  }\n};\nfunction createLineWithMarkers(scene, data) {\n  var plot = new LineWithMarkers(scene, data.uid);\n  plot.update(data);\n  return plot;\n}\nmodule.exports = createLineWithMarkers;","map":{"version":3,"names":["createLinePlot","require","gl_line3d","createScatterPlot","gl_scatter3d","createErrorBars","gl_error3d","createMesh","gl_mesh3d","triangulate","delaunay_triangulate","Lib","str2RgbaArray","formatColor","makeBubbleSizeFn","DASH_PATTERNS","MARKER_SYMBOLS","Axes","appendArrayPointValue","calculateError","LineWithMarkers","scene","uid","linePlot","scatterPlot","errorBars","textMarkers","delaunayMesh","color","mode","dataPoints","axesBounds","Infinity","textLabels","data","proto","prototype","handlePick","selection","object","ind","index","highlight","textLabel","Array","isArray","traceCoordinate","x","y","z","constructDelaunay","points","axis","u","v","filteredPoints","filteredIds","i","length","p","isNaN","isFinite","push","cells","c","j","positions","meshColor","calculateErrorParams","errors","capSize","lineWidth","e","copy_zstyle","visible","width","thickness","parseAlignmentX","a","undefined","indexOf","parseAlignmentY","calculateTextOffset","tp","defaultAlignmentX","defaultAlignmentY","textOffset","calculateSize","sizeIn","sizeFn","calculateSymbol","symbolIn","formatParam","paramIn","len","calculate","dflt","extraFn","paramOut","isArrayOrTypedArray","identity","convertPlotlyOptions","sceneLayout","fullSceneLayout","scaleFactor","dataScale","xaxis","yaxis","zaxis","marker","line","xcalendar","ycalendar","zcalendar","xc","yc","zc","params","text","d2l","formatter","axName","val","ax","tickText","texttemplate","fullLayout","d3locale","_d3locale","N","Math","min","txt","d","labels","xLabel","yLabel","zLabel","pointValues","meta","_meta","texttemplateString","position","lineColor","lineDashes","dash","scatterColor","scatterSize","size","scatterMarker","symbol","scatterLineWidth","scatterLineColor","scatterAngle","textposition","textColor","textfont","textSize","textFont","family","textAngle","dims","project","projectScale","projectOpacity","projection","show","opacity","scale","errorBounds","errorParams","error_x","error_y","error_z","errorColor","errorLineWidth","errorCapSize","delaunayAxis","surfaceaxis","delaunayColor","surfacecolor","_arrayToColor","slice","map","round","arrayToColor","colors","update","gl","glplot","lineOptions","scatterOptions","errorOptions","textOptions","dashPattern","solid","options","dashes","dashScale","connectGaps","connectgaps","_trace","add","remove","dispose","scatterOpacity","glyph","orthographic","highlightScale","angle","alignment","font","hovertext","error","delaunayOptions","createLineWithMarkers","plot","module","exports"],"sources":["/Users/lordvoldemort/django_react/second_attempt/frontend/bull_bear/node_modules/plotly.js/src/traces/scatter3d/convert.js"],"sourcesContent":["'use strict';\n\nvar createLinePlot = require('../../../stackgl_modules').gl_line3d;\nvar createScatterPlot = require('../../../stackgl_modules').gl_scatter3d;\nvar createErrorBars = require('../../../stackgl_modules').gl_error3d;\nvar createMesh = require('../../../stackgl_modules').gl_mesh3d;\nvar triangulate = require('../../../stackgl_modules').delaunay_triangulate;\n\nvar Lib = require('../../lib');\nvar str2RgbaArray = require('../../lib/str2rgbarray');\nvar formatColor = require('../../lib/gl_format_color').formatColor;\nvar makeBubbleSizeFn = require('../scatter/make_bubble_size_func');\nvar DASH_PATTERNS = require('../../constants/gl3d_dashes');\nvar MARKER_SYMBOLS = require('../../constants/gl3d_markers');\n\nvar Axes = require('../../plots/cartesian/axes');\nvar appendArrayPointValue = require('../../components/fx/helpers').appendArrayPointValue;\n\nvar calculateError = require('./calc_errors');\n\nfunction LineWithMarkers(scene, uid) {\n    this.scene = scene;\n    this.uid = uid;\n    this.linePlot = null;\n    this.scatterPlot = null;\n    this.errorBars = null;\n    this.textMarkers = null;\n    this.delaunayMesh = null;\n    this.color = null;\n    this.mode = '';\n    this.dataPoints = [];\n    this.axesBounds = [\n        [-Infinity, -Infinity, -Infinity],\n        [Infinity, Infinity, Infinity]\n    ];\n    this.textLabels = null;\n    this.data = null;\n}\n\nvar proto = LineWithMarkers.prototype;\n\nproto.handlePick = function(selection) {\n    if(selection.object &&\n        (selection.object === this.linePlot ||\n         selection.object === this.delaunayMesh ||\n         selection.object === this.textMarkers ||\n         selection.object === this.scatterPlot)\n    ) {\n        var ind = selection.index = selection.data.index;\n\n        if(selection.object.highlight) {\n            selection.object.highlight(null);\n        }\n        if(this.scatterPlot) {\n            selection.object = this.scatterPlot;\n            this.scatterPlot.highlight(selection.data);\n        }\n\n        selection.textLabel = '';\n        if(this.textLabels) {\n            if(Array.isArray(this.textLabels)) {\n                if(this.textLabels[ind] || this.textLabels[ind] === 0) {\n                    selection.textLabel = this.textLabels[ind];\n                }\n            } else {\n                selection.textLabel = this.textLabels;\n            }\n        }\n\n        selection.traceCoordinate = [\n            this.data.x[ind],\n            this.data.y[ind],\n            this.data.z[ind]\n        ];\n\n        return true;\n    }\n};\n\nfunction constructDelaunay(points, color, axis) {\n    var u = (axis + 1) % 3;\n    var v = (axis + 2) % 3;\n    var filteredPoints = [];\n    var filteredIds = [];\n    var i;\n\n    for(i = 0; i < points.length; ++i) {\n        var p = points[i];\n        if(isNaN(p[u]) || !isFinite(p[u]) ||\n           isNaN(p[v]) || !isFinite(p[v])) {\n            continue;\n        }\n        filteredPoints.push([p[u], p[v]]);\n        filteredIds.push(i);\n    }\n    var cells = triangulate(filteredPoints);\n    for(i = 0; i < cells.length; ++i) {\n        var c = cells[i];\n        for(var j = 0; j < c.length; ++j) {\n            c[j] = filteredIds[c[j]];\n        }\n    }\n    return {\n        positions: points,\n        cells: cells,\n        meshColor: color\n    };\n}\n\nfunction calculateErrorParams(errors) {\n    var capSize = [0.0, 0.0, 0.0];\n    var color = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\n    var lineWidth = [1.0, 1.0, 1.0];\n\n    for(var i = 0; i < 3; i++) {\n        var e = errors[i];\n\n        if(e && e.copy_zstyle !== false && errors[2].visible !== false) e = errors[2];\n        if(!e || !e.visible) continue;\n\n        capSize[i] = e.width / 2;  // ballpark rescaling\n        color[i] = str2RgbaArray(e.color);\n        lineWidth[i] = e.thickness;\n    }\n\n    return {capSize: capSize, color: color, lineWidth: lineWidth};\n}\n\nfunction parseAlignmentX(a) {\n    if(a === null || a === undefined) return 0;\n\n    return (a.indexOf('left') > -1) ? -1 :\n           (a.indexOf('right') > -1) ? 1 : 0;\n}\n\nfunction parseAlignmentY(a) {\n    if(a === null || a === undefined) return 0;\n\n    return (a.indexOf('top') > -1) ? -1 :\n           (a.indexOf('bottom') > -1) ? 1 : 0;\n}\n\nfunction calculateTextOffset(tp) {\n    // Read out text properties\n\n    var defaultAlignmentX = 0;\n    var defaultAlignmentY = 0;\n\n    var textOffset = [\n        defaultAlignmentX,\n        defaultAlignmentY\n    ];\n\n    if(Array.isArray(tp)) {\n        for(var i = 0; i < tp.length; i++) {\n            textOffset[i] = [\n                defaultAlignmentX,\n                defaultAlignmentY\n            ];\n            if(tp[i]) {\n                textOffset[i][0] = parseAlignmentX(tp[i]);\n                textOffset[i][1] = parseAlignmentY(tp[i]);\n            }\n        }\n    } else {\n        textOffset[0] = parseAlignmentX(tp);\n        textOffset[1] = parseAlignmentY(tp);\n    }\n\n    return textOffset;\n}\n\n\nfunction calculateSize(sizeIn, sizeFn) {\n    // rough parity with Plotly 2D markers\n    return sizeFn(sizeIn * 4);\n}\n\nfunction calculateSymbol(symbolIn) {\n    return MARKER_SYMBOLS[symbolIn];\n}\n\nfunction formatParam(paramIn, len, calculate, dflt, extraFn) {\n    var paramOut = null;\n\n    if(Lib.isArrayOrTypedArray(paramIn)) {\n        paramOut = [];\n\n        for(var i = 0; i < len; i++) {\n            if(paramIn[i] === undefined) paramOut[i] = dflt;\n            else paramOut[i] = calculate(paramIn[i], extraFn);\n        }\n    } else paramOut = calculate(paramIn, Lib.identity);\n\n    return paramOut;\n}\n\n\nfunction convertPlotlyOptions(scene, data) {\n    var points = [];\n    var sceneLayout = scene.fullSceneLayout;\n    var scaleFactor = scene.dataScale;\n    var xaxis = sceneLayout.xaxis;\n    var yaxis = sceneLayout.yaxis;\n    var zaxis = sceneLayout.zaxis;\n    var marker = data.marker;\n    var line = data.line;\n    var x = data.x || [];\n    var y = data.y || [];\n    var z = data.z || [];\n    var len = x.length;\n    var xcalendar = data.xcalendar;\n    var ycalendar = data.ycalendar;\n    var zcalendar = data.zcalendar;\n    var xc, yc, zc;\n    var params, i;\n    var text;\n\n    // Convert points\n    for(i = 0; i < len; i++) {\n        // sanitize numbers and apply transforms based on axes.type\n        xc = xaxis.d2l(x[i], 0, xcalendar) * scaleFactor[0];\n        yc = yaxis.d2l(y[i], 0, ycalendar) * scaleFactor[1];\n        zc = zaxis.d2l(z[i], 0, zcalendar) * scaleFactor[2];\n\n        points[i] = [xc, yc, zc];\n    }\n\n    // convert text\n    if(Array.isArray(data.text)) text = data.text;\n    else if(data.text !== undefined) {\n        text = new Array(len);\n        for(i = 0; i < len; i++) text[i] = data.text;\n    }\n\n    function formatter(axName, val) {\n        var ax = sceneLayout[axName];\n        return Axes.tickText(ax, ax.d2l(val), true).text;\n    }\n\n    // check texttemplate\n    var texttemplate = data.texttemplate;\n    if(texttemplate) {\n        var fullLayout = scene.fullLayout;\n        var d3locale = fullLayout._d3locale;\n        var isArray = Array.isArray(texttemplate);\n        var N = isArray ? Math.min(texttemplate.length, len) : len;\n        var txt = isArray ?\n            function(i) { return texttemplate[i]; } :\n            function() { return texttemplate; };\n\n        text = new Array(N);\n\n        for(i = 0; i < N; i++) {\n            var d = {x: x[i], y: y[i], z: z[i]};\n            var labels = {\n                xLabel: formatter('xaxis', x[i]),\n                yLabel: formatter('yaxis', y[i]),\n                zLabel: formatter('zaxis', z[i])\n            };\n            var pointValues = {};\n            appendArrayPointValue(pointValues, data, i);\n            var meta = data._meta || {};\n            text[i] = Lib.texttemplateString(txt(i), labels, d3locale, pointValues, d, meta);\n        }\n    }\n\n    // Build object parameters\n    params = {\n        position: points,\n        mode: data.mode,\n        text: text\n    };\n\n    if('line' in data) {\n        params.lineColor = formatColor(line, 1, len);\n        params.lineWidth = line.width;\n        params.lineDashes = line.dash;\n    }\n\n    if('marker' in data) {\n        var sizeFn = makeBubbleSizeFn(data);\n\n        params.scatterColor = formatColor(marker, 1, len);\n        params.scatterSize = formatParam(marker.size, len, calculateSize, 20, sizeFn);\n        params.scatterMarker = formatParam(marker.symbol, len, calculateSymbol, '●');\n        params.scatterLineWidth = marker.line.width;  // arrayOk === false\n        params.scatterLineColor = formatColor(marker.line, 1, len);\n        params.scatterAngle = 0;\n    }\n\n    if('textposition' in data) {\n        params.textOffset = calculateTextOffset(data.textposition);\n        params.textColor = formatColor(data.textfont, 1, len);\n        params.textSize = formatParam(data.textfont.size, len, Lib.identity, 12);\n        params.textFont = data.textfont.family;  // arrayOk === false\n        params.textAngle = 0;\n    }\n\n    var dims = ['x', 'y', 'z'];\n    params.project = [false, false, false];\n    params.projectScale = [1, 1, 1];\n    params.projectOpacity = [1, 1, 1];\n    for(i = 0; i < 3; ++i) {\n        var projection = data.projection[dims[i]];\n        if((params.project[i] = projection.show)) {\n            params.projectOpacity[i] = projection.opacity;\n            params.projectScale[i] = projection.scale;\n        }\n    }\n\n    params.errorBounds = calculateError(data, scaleFactor, sceneLayout);\n\n    var errorParams = calculateErrorParams([data.error_x, data.error_y, data.error_z]);\n    params.errorColor = errorParams.color;\n    params.errorLineWidth = errorParams.lineWidth;\n    params.errorCapSize = errorParams.capSize;\n\n    params.delaunayAxis = data.surfaceaxis;\n    params.delaunayColor = str2RgbaArray(data.surfacecolor);\n\n    return params;\n}\n\nfunction _arrayToColor(color) {\n    if(Lib.isArrayOrTypedArray(color)) {\n        var c = color[0];\n\n        if(Lib.isArrayOrTypedArray(c)) color = c;\n\n        return 'rgb(' + color.slice(0, 3).map(function(x) {\n            return Math.round(x * 255);\n        }) + ')';\n    }\n\n    return null;\n}\n\nfunction arrayToColor(colors) {\n    if(!Lib.isArrayOrTypedArray(colors)) {\n        return null;\n    }\n\n    if((colors.length === 4) && (typeof colors[0] === 'number')) {\n        return _arrayToColor(colors);\n    }\n\n    return colors.map(_arrayToColor);\n}\n\nproto.update = function(data) {\n    var gl = this.scene.glplot.gl;\n    var lineOptions;\n    var scatterOptions;\n    var errorOptions;\n    var textOptions;\n    var dashPattern = DASH_PATTERNS.solid;\n\n    // Save data\n    this.data = data;\n\n    // Run data conversion\n    var options = convertPlotlyOptions(this.scene, data);\n\n    if('mode' in options) {\n        this.mode = options.mode;\n    }\n    if('lineDashes' in options) {\n        if(options.lineDashes in DASH_PATTERNS) {\n            dashPattern = DASH_PATTERNS[options.lineDashes];\n        }\n    }\n\n    this.color = arrayToColor(options.scatterColor) ||\n                 arrayToColor(options.lineColor);\n\n    // Save data points\n    this.dataPoints = options.position;\n\n    lineOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.lineColor,\n        lineWidth: options.lineWidth || 1,\n        dashes: dashPattern[0],\n        dashScale: dashPattern[1],\n        opacity: data.opacity,\n        connectGaps: data.connectgaps\n    };\n\n    if(this.mode.indexOf('lines') !== -1) {\n        if(this.linePlot) this.linePlot.update(lineOptions);\n        else {\n            this.linePlot = createLinePlot(lineOptions);\n            this.linePlot._trace = this;\n            this.scene.glplot.add(this.linePlot);\n        }\n    } else if(this.linePlot) {\n        this.scene.glplot.remove(this.linePlot);\n        this.linePlot.dispose();\n        this.linePlot = null;\n    }\n\n    // N.B. marker.opacity must be a scalar for performance\n    var scatterOpacity = data.opacity;\n    if(data.marker && data.marker.opacity) scatterOpacity *= data.marker.opacity;\n\n    scatterOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.scatterColor,\n        size: options.scatterSize,\n        glyph: options.scatterMarker,\n        opacity: scatterOpacity,\n        orthographic: true,\n        lineWidth: options.scatterLineWidth,\n        lineColor: options.scatterLineColor,\n        project: options.project,\n        projectScale: options.projectScale,\n        projectOpacity: options.projectOpacity\n    };\n\n    if(this.mode.indexOf('markers') !== -1) {\n        if(this.scatterPlot) this.scatterPlot.update(scatterOptions);\n        else {\n            this.scatterPlot = createScatterPlot(scatterOptions);\n            this.scatterPlot._trace = this;\n            this.scatterPlot.highlightScale = 1;\n            this.scene.glplot.add(this.scatterPlot);\n        }\n    } else if(this.scatterPlot) {\n        this.scene.glplot.remove(this.scatterPlot);\n        this.scatterPlot.dispose();\n        this.scatterPlot = null;\n    }\n\n    textOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        glyph: options.text,\n        color: options.textColor,\n        size: options.textSize,\n        angle: options.textAngle,\n        alignment: options.textOffset,\n        font: options.textFont,\n        orthographic: true,\n        lineWidth: 0,\n        project: false,\n        opacity: data.opacity\n    };\n\n    this.textLabels = data.hovertext || data.text;\n\n    if(this.mode.indexOf('text') !== -1) {\n        if(this.textMarkers) this.textMarkers.update(textOptions);\n        else {\n            this.textMarkers = createScatterPlot(textOptions);\n            this.textMarkers._trace = this;\n            this.textMarkers.highlightScale = 1;\n            this.scene.glplot.add(this.textMarkers);\n        }\n    } else if(this.textMarkers) {\n        this.scene.glplot.remove(this.textMarkers);\n        this.textMarkers.dispose();\n        this.textMarkers = null;\n    }\n\n    errorOptions = {\n        gl: this.scene.glplot.gl,\n        position: options.position,\n        color: options.errorColor,\n        error: options.errorBounds,\n        lineWidth: options.errorLineWidth,\n        capSize: options.errorCapSize,\n        opacity: data.opacity\n    };\n    if(this.errorBars) {\n        if(options.errorBounds) {\n            this.errorBars.update(errorOptions);\n        } else {\n            this.scene.glplot.remove(this.errorBars);\n            this.errorBars.dispose();\n            this.errorBars = null;\n        }\n    } else if(options.errorBounds) {\n        this.errorBars = createErrorBars(errorOptions);\n        this.errorBars._trace = this;\n        this.scene.glplot.add(this.errorBars);\n    }\n\n    if(options.delaunayAxis >= 0) {\n        var delaunayOptions = constructDelaunay(\n            options.position,\n            options.delaunayColor,\n            options.delaunayAxis\n        );\n        delaunayOptions.opacity = data.opacity;\n\n        if(this.delaunayMesh) {\n            this.delaunayMesh.update(delaunayOptions);\n        } else {\n            delaunayOptions.gl = gl;\n            this.delaunayMesh = createMesh(delaunayOptions);\n            this.delaunayMesh._trace = this;\n            this.scene.glplot.add(this.delaunayMesh);\n        }\n    } else if(this.delaunayMesh) {\n        this.scene.glplot.remove(this.delaunayMesh);\n        this.delaunayMesh.dispose();\n        this.delaunayMesh = null;\n    }\n};\n\nproto.dispose = function() {\n    if(this.linePlot) {\n        this.scene.glplot.remove(this.linePlot);\n        this.linePlot.dispose();\n    }\n    if(this.scatterPlot) {\n        this.scene.glplot.remove(this.scatterPlot);\n        this.scatterPlot.dispose();\n    }\n    if(this.errorBars) {\n        this.scene.glplot.remove(this.errorBars);\n        this.errorBars.dispose();\n    }\n    if(this.textMarkers) {\n        this.scene.glplot.remove(this.textMarkers);\n        this.textMarkers.dispose();\n    }\n    if(this.delaunayMesh) {\n        this.scene.glplot.remove(this.delaunayMesh);\n        this.delaunayMesh.dispose();\n    }\n};\n\nfunction createLineWithMarkers(scene, data) {\n    var plot = new LineWithMarkers(scene, data.uid);\n    plot.update(data);\n    return plot;\n}\n\nmodule.exports = createLineWithMarkers;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}