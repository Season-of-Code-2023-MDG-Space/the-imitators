{"ast":null,"code":"'use strict';\n\nvar conePlot = require('../../../stackgl_modules').gl_cone3d;\nvar createConeMesh = require('../../../stackgl_modules').gl_cone3d.createConeMesh;\nvar simpleMap = require('../../lib').simpleMap;\nvar parseColorScale = require('../../lib/gl_format_color').parseColorScale;\nvar extractOpts = require('../../components/colorscale').extractOpts;\nvar zip3 = require('../../plots/gl3d/zip3');\nfunction Cone(scene, uid) {\n  this.scene = scene;\n  this.uid = uid;\n  this.mesh = null;\n  this.data = null;\n}\nvar proto = Cone.prototype;\nproto.handlePick = function (selection) {\n  if (selection.object === this.mesh) {\n    var selectIndex = selection.index = selection.data.index;\n    var xx = this.data.x[selectIndex];\n    var yy = this.data.y[selectIndex];\n    var zz = this.data.z[selectIndex];\n    var uu = this.data.u[selectIndex];\n    var vv = this.data.v[selectIndex];\n    var ww = this.data.w[selectIndex];\n    selection.traceCoordinate = [xx, yy, zz, uu, vv, ww, Math.sqrt(uu * uu + vv * vv + ww * ww)];\n    var text = this.data.hovertext || this.data.text;\n    if (Array.isArray(text) && text[selectIndex] !== undefined) {\n      selection.textLabel = text[selectIndex];\n    } else if (text) {\n      selection.textLabel = text;\n    }\n    return true;\n  }\n};\nvar axisName2scaleIndex = {\n  xaxis: 0,\n  yaxis: 1,\n  zaxis: 2\n};\nvar anchor2coneOffset = {\n  tip: 1,\n  tail: 0,\n  cm: 0.25,\n  center: 0.5\n};\nvar anchor2coneSpan = {\n  tip: 1,\n  tail: 1,\n  cm: 0.75,\n  center: 0.5\n};\nfunction convert(scene, trace) {\n  var sceneLayout = scene.fullSceneLayout;\n  var dataScale = scene.dataScale;\n  var coneOpts = {};\n  function toDataCoords(arr, axisName) {\n    var ax = sceneLayout[axisName];\n    var scale = dataScale[axisName2scaleIndex[axisName]];\n    return simpleMap(arr, function (v) {\n      return ax.d2l(v) * scale;\n    });\n  }\n  coneOpts.vectors = zip3(toDataCoords(trace.u, 'xaxis'), toDataCoords(trace.v, 'yaxis'), toDataCoords(trace.w, 'zaxis'), trace._len);\n  coneOpts.positions = zip3(toDataCoords(trace.x, 'xaxis'), toDataCoords(trace.y, 'yaxis'), toDataCoords(trace.z, 'zaxis'), trace._len);\n  var cOpts = extractOpts(trace);\n  coneOpts.colormap = parseColorScale(trace);\n  coneOpts.vertexIntensityBounds = [cOpts.min / trace._normMax, cOpts.max / trace._normMax];\n  coneOpts.coneOffset = anchor2coneOffset[trace.anchor];\n  if (trace.sizemode === 'scaled') {\n    // unitless sizeref\n    coneOpts.coneSize = trace.sizeref || 0.5;\n  } else {\n    // sizeref here has unit of velocity\n    coneOpts.coneSize = trace.sizeref && trace._normMax ? trace.sizeref / trace._normMax : 0.5;\n  }\n  var meshData = conePlot(coneOpts);\n\n  // pass gl-mesh3d lighting attributes\n  var lp = trace.lightposition;\n  meshData.lightPosition = [lp.x, lp.y, lp.z];\n  meshData.ambient = trace.lighting.ambient;\n  meshData.diffuse = trace.lighting.diffuse;\n  meshData.specular = trace.lighting.specular;\n  meshData.roughness = trace.lighting.roughness;\n  meshData.fresnel = trace.lighting.fresnel;\n  meshData.opacity = trace.opacity;\n\n  // stash autorange pad value\n  trace._pad = anchor2coneSpan[trace.anchor] * meshData.vectorScale * meshData.coneScale * trace._normMax;\n  return meshData;\n}\nproto.update = function (data) {\n  this.data = data;\n  var meshData = convert(this.scene, data);\n  this.mesh.update(meshData);\n};\nproto.dispose = function () {\n  this.scene.glplot.remove(this.mesh);\n  this.mesh.dispose();\n};\nfunction createConeTrace(scene, data) {\n  var gl = scene.glplot.gl;\n  var meshData = convert(scene, data);\n  var mesh = createConeMesh(gl, meshData);\n  var cone = new Cone(scene, data.uid);\n  cone.mesh = mesh;\n  cone.data = data;\n  mesh._trace = cone;\n  scene.glplot.add(mesh);\n  return cone;\n}\nmodule.exports = createConeTrace;","map":{"version":3,"names":["conePlot","require","gl_cone3d","createConeMesh","simpleMap","parseColorScale","extractOpts","zip3","Cone","scene","uid","mesh","data","proto","prototype","handlePick","selection","object","selectIndex","index","xx","x","yy","y","zz","z","uu","u","vv","v","ww","w","traceCoordinate","Math","sqrt","text","hovertext","Array","isArray","undefined","textLabel","axisName2scaleIndex","xaxis","yaxis","zaxis","anchor2coneOffset","tip","tail","cm","center","anchor2coneSpan","convert","trace","sceneLayout","fullSceneLayout","dataScale","coneOpts","toDataCoords","arr","axisName","ax","scale","d2l","vectors","_len","positions","cOpts","colormap","vertexIntensityBounds","min","_normMax","max","coneOffset","anchor","sizemode","coneSize","sizeref","meshData","lp","lightposition","lightPosition","ambient","lighting","diffuse","specular","roughness","fresnel","opacity","_pad","vectorScale","coneScale","update","dispose","glplot","remove","createConeTrace","gl","cone","_trace","add","module","exports"],"sources":["/Users/lordvoldemort/django_react/second_attempt/frontend/bull_bear/node_modules/plotly.js/src/traces/cone/convert.js"],"sourcesContent":["'use strict';\n\nvar conePlot = require('../../../stackgl_modules').gl_cone3d;\nvar createConeMesh = require('../../../stackgl_modules').gl_cone3d.createConeMesh;\n\nvar simpleMap = require('../../lib').simpleMap;\nvar parseColorScale = require('../../lib/gl_format_color').parseColorScale;\nvar extractOpts = require('../../components/colorscale').extractOpts;\nvar zip3 = require('../../plots/gl3d/zip3');\n\nfunction Cone(scene, uid) {\n    this.scene = scene;\n    this.uid = uid;\n    this.mesh = null;\n    this.data = null;\n}\n\nvar proto = Cone.prototype;\n\nproto.handlePick = function(selection) {\n    if(selection.object === this.mesh) {\n        var selectIndex = selection.index = selection.data.index;\n        var xx = this.data.x[selectIndex];\n        var yy = this.data.y[selectIndex];\n        var zz = this.data.z[selectIndex];\n        var uu = this.data.u[selectIndex];\n        var vv = this.data.v[selectIndex];\n        var ww = this.data.w[selectIndex];\n\n        selection.traceCoordinate = [\n            xx, yy, zz,\n            uu, vv, ww,\n            Math.sqrt(uu * uu + vv * vv + ww * ww)\n        ];\n\n        var text = this.data.hovertext || this.data.text;\n        if(Array.isArray(text) && text[selectIndex] !== undefined) {\n            selection.textLabel = text[selectIndex];\n        } else if(text) {\n            selection.textLabel = text;\n        }\n\n        return true;\n    }\n};\n\nvar axisName2scaleIndex = {xaxis: 0, yaxis: 1, zaxis: 2};\nvar anchor2coneOffset = {tip: 1, tail: 0, cm: 0.25, center: 0.5};\nvar anchor2coneSpan = {tip: 1, tail: 1, cm: 0.75, center: 0.5};\n\nfunction convert(scene, trace) {\n    var sceneLayout = scene.fullSceneLayout;\n    var dataScale = scene.dataScale;\n    var coneOpts = {};\n\n    function toDataCoords(arr, axisName) {\n        var ax = sceneLayout[axisName];\n        var scale = dataScale[axisName2scaleIndex[axisName]];\n        return simpleMap(arr, function(v) { return ax.d2l(v) * scale; });\n    }\n\n    coneOpts.vectors = zip3(\n        toDataCoords(trace.u, 'xaxis'),\n        toDataCoords(trace.v, 'yaxis'),\n        toDataCoords(trace.w, 'zaxis'),\n        trace._len\n    );\n\n    coneOpts.positions = zip3(\n        toDataCoords(trace.x, 'xaxis'),\n        toDataCoords(trace.y, 'yaxis'),\n        toDataCoords(trace.z, 'zaxis'),\n        trace._len\n    );\n\n    var cOpts = extractOpts(trace);\n    coneOpts.colormap = parseColorScale(trace);\n    coneOpts.vertexIntensityBounds = [cOpts.min / trace._normMax, cOpts.max / trace._normMax];\n    coneOpts.coneOffset = anchor2coneOffset[trace.anchor];\n\n    if(trace.sizemode === 'scaled') {\n        // unitless sizeref\n        coneOpts.coneSize = trace.sizeref || 0.5;\n    } else {\n        // sizeref here has unit of velocity\n        coneOpts.coneSize = trace.sizeref && trace._normMax ?\n            trace.sizeref / trace._normMax :\n            0.5;\n    }\n\n    var meshData = conePlot(coneOpts);\n\n    // pass gl-mesh3d lighting attributes\n    var lp = trace.lightposition;\n    meshData.lightPosition = [lp.x, lp.y, lp.z];\n    meshData.ambient = trace.lighting.ambient;\n    meshData.diffuse = trace.lighting.diffuse;\n    meshData.specular = trace.lighting.specular;\n    meshData.roughness = trace.lighting.roughness;\n    meshData.fresnel = trace.lighting.fresnel;\n    meshData.opacity = trace.opacity;\n\n    // stash autorange pad value\n    trace._pad = anchor2coneSpan[trace.anchor] * meshData.vectorScale * meshData.coneScale * trace._normMax;\n\n    return meshData;\n}\n\nproto.update = function(data) {\n    this.data = data;\n\n    var meshData = convert(this.scene, data);\n    this.mesh.update(meshData);\n};\n\nproto.dispose = function() {\n    this.scene.glplot.remove(this.mesh);\n    this.mesh.dispose();\n};\n\nfunction createConeTrace(scene, data) {\n    var gl = scene.glplot.gl;\n\n    var meshData = convert(scene, data);\n    var mesh = createConeMesh(gl, meshData);\n\n    var cone = new Cone(scene, data.uid);\n    cone.mesh = mesh;\n    cone.data = data;\n    mesh._trace = cone;\n\n    scene.glplot.add(mesh);\n\n    return cone;\n}\n\nmodule.exports = createConeTrace;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}