{"ast":null,"code":"var os = require('os');\nvar util = require('util');\nvar _ = require('lodash');\nvar S = require('string');\nvar moment = require('moment');\nvar Promise = require('bluebird');\nvar _constants = require('./constants');\nvar _fields = require('./snapshotFields');\nvar _utils = require('./utils');\nvar getCrumb = require('./yahooCrumb').getCrumb;\nvar dateFields = require('./quote').dateFields;\nvar FIELDS_MAP_GITHUB_URL = 'https://github.com/pilwon/node-yahoo-finance/blob/master/lib/snapshotFields.js#L111';\n\n// Fields from the old API that can be mapped to the current data\nvar mappedFields = _.filter(_.keys(_fields._map), function (field) {\n  return !!_fields._map[field];\n});\nvar requiredModuleForField = {};\n_.each(mappedFields, function (field) {\n  requiredModuleForField[field] = _fields._map[field].split('.')[0];\n});\n\n// Given a list of fields, return the names of all the modules needed to\n// supply them.\nfunction requiredModulesForFields(fields) {\n  var modules = [];\n  _.each(fields, function (field) {\n    var module = requiredModuleForField[field];\n    if (modules.indexOf(module) === -1) modules.push(module);\n  });\n  return modules;\n}\nvar shownWarning = false;\nfunction _sanitizeSnapshotOptions(options) {\n  if (!_.isPlainObject(options)) {\n    throw new Error('\"options\" must be a plain object.');\n  }\n  if (_.isUndefined(options.symbol) && _.isUndefined(options.symbols)) {\n    throw new Error('Either \"options.symbol\" or \"options.symbols\" must be defined.');\n  }\n  if (!_.isUndefined(options.symbol) && !_.isUndefined(options.symbols)) {\n    throw new Error('Either \"options.symbol\" or \"options.symbols\" must be undefined.');\n  }\n  if (!_.isUndefined(options.symbol)) {\n    if (!_.isString(options.symbol) || _.isEmpty(options.symbol)) {\n      throw new Error('\"options.symbol\" must be a non-empty string.');\n    }\n  } else {\n    if (!_.isArray(options.symbols) || _.isEmpty(options.symbols)) {\n      throw new Error('\"options.symbols\" must be a non-empty string array.');\n    }\n  }\n  if ((!_.isArray(options.fields) || _.isEmpty(options.fields)) && !_.isUndefined(options.fields)) {\n    throw new Error('\"options.fields\" must be a non-empty string array or undefined.');\n  }\n  if (options.fields) {\n    var unavailable = _.difference(options.fields, mappedFields);\n    if (unavailable.length) throw new Error(\"[yahoo-finance] snapshot(): The following fields \" + \"are no longer available in Yahoo's new API: \" + JSON.stringify(unavailable) + \".  See if you can find something similar in the new quote() API, \" + \"otherwise unfortunately, you are out of luck.  Yahoo ended support \" + \"for their developer API some time ago and made no guarantees to \" + \"maintain that API.  You may want to also check our mapping function \" + \"at \" + FIELDS_MAP_GITHUB_URL);\n    if (!shownWarning) {\n      console.warn(\"[yahoo-finance] snapshot() has been deprecated.  The \" + \"Yahoo Finance API has fundamentally changed recently.  We will \" + \"attempt to map the requested fields from the new API according to \" + FIELDS_MAP_GITHUB_URL + \".  Please double check this map and your results to ensure \" + \"consistency.  This warning will only be shown once.\");\n      shownWarning = true;\n    }\n  } else {\n    if (!options.ignoreAllFieldsWarning) {\n      throw new Error(\"[yahoo-finance] snapshot(): No `fields` property was \" + \"given.  This used to return all fields available, but not all these \" + \"fields are available in Yahoo's new API.  We suggest you update \" + \"your code to use the new quote() API instead.  However, you can \" + \"simply specify the exact fields you need, and they'll be fetched if \" + \"available.  Alternative, pass { ignoreAllFieldsWarning: true } and \" + \"all available fields (from the new API) will be returned.  You can \" + \"see the full list of available mappings at \" + FIELDS_MAP_GITHUB_URL);\n    } else {\n      // fetch all fields if undefined\n      options.fields = mappedFields;\n    }\n  }\n  options.modules = requiredModulesForFields(options.fields);\n}\nfunction _transformSnapshot(fields, symbols, data) {\n  var quoteSummary = data.quoteSummary;\n  if (!quoteSummary || quoteSummary.error) throw new Error(quoteSummary.error);\n  var result = quoteSummary.result;\n  if (!_.isArray(result) || result.length > 1) throw new Error(\"quoteSummary format has changed, please report this.\");\n  result = result[0];\n\n  // for 'n', store 'name' from result.price.name, etc.\n  // for arrays like 'c', combine values into an array\n  var out = {};\n  _.each(fields, function (field) {\n    // map { c: 'price.regularMarketChange,price.regularMarketChangePercent' }\n    if (_fields._map[field].indexOf(',') > 0) {\n      var dest = out[_utils.camelize(_fields[field])] = [];\n      _.map(_fields._map[field].split(','), function (map) {\n        // 'price.symbol' => ['price','symbol']\n        map = map.split('.');\n        dest.push(result[map[0]][map[1]]);\n        // Assumption: no arrays use date fields (currently true)\n      });\n    } else {\n      // 'price.symbol' => ['price','symbol']\n      var map = _fields._map[field].split('.');\n      var value = result[map[0]][map[1]];\n      if (dateFields[map[0]] && dateFields[map[0]].indexOf(map[1]) !== -1) value = new Date(value * 1000);\n      out[_utils.camelize(_fields[field])] = value;\n    }\n  });\n  return out;\n}\nfunction snapshot(options, optionalHttpRequestOptions, cb) {\n  var symbols = options.symbols || _.flatten([options.symbol]);\n  options = _.clone(options);\n  _sanitizeSnapshotOptions(options);\n  if (optionalHttpRequestOptions && typeof optionalHttpRequestOptions == 'function') {\n    cb = optionalHttpRequestOptions;\n    optionalHttpRequestOptions = {};\n  } else if (!optionalHttpRequestOptions) {\n    optionalHttpRequestOptions = {};\n  }\n  optionalHttpRequestOptions.json = true;\n  return getCrumb(symbols[0]).then(function (crumb) {\n    return Promise.map(symbols, function (symbol) {\n      var url = _constants.SNAPSHOT_URL.replace(/\\$SYMBOL/, symbol);\n      return _utils.download(url, {\n        formatted: 'false',\n        crumb: crumb,\n        modules: options.modules.join(','),\n        corsDomain: 'finance.yahoo.com'\n      }, optionalHttpRequestOptions).then(function (data) {\n        return _transformSnapshot(options.fields, symbols, data);\n      });\n    }, {\n      concurrency: options.maxConcurrentSymbols || os.cpus().length\n    }).then(function (results) {\n      if (options.symbols) {\n        return _.zipObject(symbols, results);\n      } else {\n        return results[0];\n      }\n    }).catch(function (err) {\n      throw new Error(util.format('Failed to download data (%s)', err.message));\n    }).nodeify(cb);\n  });\n}\n\n// API (ES6 syntax with default export)\nexports.__esModule = true;\nexports.default = snapshot;\n\n// For testing\nexports.mappedFields = mappedFields;","map":{"version":3,"names":["os","require","util","_","S","moment","Promise","_constants","_fields","_utils","getCrumb","dateFields","FIELDS_MAP_GITHUB_URL","mappedFields","filter","keys","_map","field","requiredModuleForField","each","split","requiredModulesForFields","fields","modules","module","indexOf","push","shownWarning","_sanitizeSnapshotOptions","options","isPlainObject","Error","isUndefined","symbol","symbols","isString","isEmpty","isArray","unavailable","difference","length","JSON","stringify","console","warn","ignoreAllFieldsWarning","_transformSnapshot","data","quoteSummary","error","result","out","dest","camelize","map","value","Date","snapshot","optionalHttpRequestOptions","cb","flatten","clone","json","then","crumb","url","SNAPSHOT_URL","replace","download","formatted","join","corsDomain","concurrency","maxConcurrentSymbols","cpus","results","zipObject","catch","err","format","message","nodeify","exports","__esModule","default"],"sources":["/Users/lordvoldemort/IdeaProjects/Webdevelopment/Bulls and Bears/bull_bear/node_modules/yahoo-finance/lib/snapshot.js"],"sourcesContent":["var os = require('os');\nvar util = require('util');\n\nvar _ = require('lodash');\nvar S = require('string');\nvar moment = require('moment');\nvar Promise = require('bluebird');\n\nvar _constants = require('./constants');\nvar _fields = require('./snapshotFields');\nvar _utils = require('./utils');\nvar getCrumb = require('./yahooCrumb').getCrumb;\n\nvar dateFields = require('./quote').dateFields;\n\nvar FIELDS_MAP_GITHUB_URL = 'https://github.com/pilwon/node-yahoo-finance/blob/master/lib/snapshotFields.js#L111';\n\n// Fields from the old API that can be mapped to the current data\nvar mappedFields = _.filter(_.keys(_fields._map), function(field) {\n  return !!_fields._map[field]\n});\n\nvar requiredModuleForField = {};\n_.each(mappedFields, function(field) {\n  requiredModuleForField[field] = _fields._map[field].split('.')[0];\n});\n\n// Given a list of fields, return the names of all the modules needed to\n// supply them.\nfunction requiredModulesForFields(fields) {\n  var modules = [];\n  _.each(fields, function(field) {\n    var module = requiredModuleForField[field];\n    if (modules.indexOf(module) === -1)\n      modules.push(module);\n  });\n  return modules;\n}\n\nvar shownWarning = false;\n\nfunction _sanitizeSnapshotOptions(options) {\n  if (!_.isPlainObject(options)) {\n    throw new Error('\"options\" must be a plain object.');\n  }\n  if (_.isUndefined(options.symbol) && _.isUndefined(options.symbols)) {\n    throw new Error('Either \"options.symbol\" or \"options.symbols\" must be defined.');\n  }\n  if (!_.isUndefined(options.symbol) && !_.isUndefined(options.symbols)) {\n    throw new Error('Either \"options.symbol\" or \"options.symbols\" must be undefined.');\n  }\n\n  if (!_.isUndefined(options.symbol)) {\n    if (!_.isString(options.symbol) || _.isEmpty(options.symbol)) {\n      throw new Error('\"options.symbol\" must be a non-empty string.');\n    }\n  } else {\n    if (!_.isArray(options.symbols) || _.isEmpty(options.symbols)) {\n      throw new Error('\"options.symbols\" must be a non-empty string array.');\n    }\n  }\n\n  if ((!_.isArray(options.fields) || _.isEmpty(options.fields)) && !_.isUndefined(options.fields)) {\n    throw new Error('\"options.fields\" must be a non-empty string array or undefined.');\n  }\n\n  if (options.fields) {\n\n    var unavailable = _.difference(options.fields, mappedFields);\n    if (unavailable.length)\n      throw new Error(\"[yahoo-finance] snapshot(): The following fields \" +\n        \"are no longer available in Yahoo's new API: \" +\n        JSON.stringify(unavailable) +\n        \".  See if you can find something similar in the new quote() API, \" +\n        \"otherwise unfortunately, you are out of luck.  Yahoo ended support \" +\n        \"for their developer API some time ago and made no guarantees to \" +\n        \"maintain that API.  You may want to also check our mapping function \" +\n        \"at \" + FIELDS_MAP_GITHUB_URL);\n\n    if (!shownWarning) {\n      console.warn(\"[yahoo-finance] snapshot() has been deprecated.  The \" +\n        \"Yahoo Finance API has fundamentally changed recently.  We will \" +\n        \"attempt to map the requested fields from the new API according to \" +\n        FIELDS_MAP_GITHUB_URL +\n        \".  Please double check this map and your results to ensure \" +\n        \"consistency.  This warning will only be shown once.\");\n      shownWarning = true;\n    }\n\n  } else {\n\n    if (!options.ignoreAllFieldsWarning) {\n      throw new Error(\"[yahoo-finance] snapshot(): No `fields` property was \" +\n        \"given.  This used to return all fields available, but not all these \" +\n        \"fields are available in Yahoo's new API.  We suggest you update \" +\n        \"your code to use the new quote() API instead.  However, you can \" +\n        \"simply specify the exact fields you need, and they'll be fetched if \" +\n        \"available.  Alternative, pass { ignoreAllFieldsWarning: true } and \" +\n        \"all available fields (from the new API) will be returned.  You can \" +\n        \"see the full list of available mappings at \" + FIELDS_MAP_GITHUB_URL);\n    } else {\n      // fetch all fields if undefined\n      options.fields = mappedFields;\n    }\n\n  }\n\n  options.modules = requiredModulesForFields(options.fields);\n}\n\nfunction _transformSnapshot(fields, symbols, data) {\n  var quoteSummary = data.quoteSummary;\n  if (!quoteSummary || quoteSummary.error)\n    throw new Error(quoteSummary.error);\n\n  var result = quoteSummary.result;\n  if (!_.isArray(result) || result.length > 1)\n    throw new Error(\"quoteSummary format has changed, please report this.\");\n\n  result = result[0];\n\n  // for 'n', store 'name' from result.price.name, etc.\n  // for arrays like 'c', combine values into an array\n  var out = {};\n  _.each(fields, function(field) {\n    // map { c: 'price.regularMarketChange,price.regularMarketChangePercent' }\n    if (_fields._map[field].indexOf(',') > 0) {\n      var dest = out[_utils.camelize(_fields[field])] = [];\n      _.map(_fields._map[field].split(','), function(map) {\n        // 'price.symbol' => ['price','symbol']\n        map = map.split('.');\n        dest.push(result[map[0]][map[1]]);\n        // Assumption: no arrays use date fields (currently true)\n      });\n    } else {\n      // 'price.symbol' => ['price','symbol']\n      var map = _fields._map[field].split('.');\n      var value = result[map[0]][map[1]];\n\n      if (dateFields[map[0]] && dateFields[map[0]].indexOf(map[1]) !== -1)\n        value = new Date(value * 1000);\n\n      out[_utils.camelize(_fields[field])] = value;\n    }\n  });\n\n  return out;\n}\n\nfunction snapshot(options, optionalHttpRequestOptions, cb) {\n  var symbols = options.symbols || _.flatten([options.symbol]);\n  options = _.clone(options);\n  _sanitizeSnapshotOptions(options);\n\n  if(optionalHttpRequestOptions && typeof optionalHttpRequestOptions == 'function') {\n    cb = optionalHttpRequestOptions;\n    optionalHttpRequestOptions = {};\n  } else if (!optionalHttpRequestOptions) {\n    optionalHttpRequestOptions = {};\n  }\n\n  optionalHttpRequestOptions.json = true;\n\n  return getCrumb(symbols[0])\n    .then(function(crumb) {\n      return Promise.map(symbols, function (symbol) {\n        var url = _constants.SNAPSHOT_URL.replace(/\\$SYMBOL/, symbol);\n        return _utils.download(url, {\n            formatted: 'false',\n            crumb: crumb,\n            modules: options.modules.join(','),\n            corsDomain: 'finance.yahoo.com'\n          }, optionalHttpRequestOptions)\n          .then(function (data) {\n            return _transformSnapshot(options.fields, symbols, data);\n          })\n      }, {concurrency: options.maxConcurrentSymbols || os.cpus().length})\n      .then(function (results) {\n        if (options.symbols) {\n          return _.zipObject(symbols, results);\n        } else {\n          return results[0];\n        }\n      })\n      .catch(function (err) {\n        throw new Error(util.format('Failed to download data (%s)', err.message));\n      })\n      .nodeify(cb);\n    });\n}\n\n// API (ES6 syntax with default export)\nexports.__esModule = true;\nexports.default = snapshot;\n\n// For testing\nexports.mappedFields = mappedFields;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}